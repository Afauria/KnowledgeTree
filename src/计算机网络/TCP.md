暂未整理，推荐阅读：[小林coding-图解网络介绍](https://xiaolincoding.com/network/)

https://mp.weixin.qq.com/s/G3np-WgQu3hZNICoso4X1w

https://baijiahao.baidu.com/s?id=1654225744653405133&wfr=spider&for=pc

IP层不保证网络包是否完整以及按序交付，因此需要传输层控制

# TCP报头

<img src="TCP/TCP报头.png" style="zoom:50%;" />

SYN：Synchronization，同步请求

ACK：acknowledgetment，确认已收到

FIN：finish，结束

x是客户端起始序列化号，y是服务端起始序列号，由发送方随机生成，没发送一次+1，用于解决包乱序问题

ack可以理解为希望对方回复的下一个序列号

TCP四元组：源地址、源端口、目标地址、目标端口



# 三次握手和四次挥手

三次握手：

1. 客户端发送：SYN=1，seq=x
2. 服务端断开Listner状态，回复：SYN=1，ACK=1，seq=y，ack=x+1
3. 客户端回复：ACK=1，seq=x+1，ack=y+1

<img src="TCP/tcp三次握手.png" style="zoom: 50%;" />

为什么需要三次握手？

> 1. 两次握手，客户端可能没收到消息，超时关闭并重新连接，服务端还保持着原来的连接
> 2. 同步两端的序列号

<img src="TCP/四次挥手.png" style="zoom: 50%;" />

为什么要四次挥手

# TCP和UDP

|              | UDP                                        | TCP                                    |
| :----------- | :----------------------------------------- | :------------------------------------- |
| 是否连接     | 无连接                                     | 面向连接                               |
| 是否可靠     | 不可靠传输，不使用流量控制和拥塞控制       | 可靠传输，使用流量控制和拥塞控制       |
| 连接对象个数 | 支持一对一，一对多，多对一和多对多交互通信 | 只能是一对一通信                       |
| 传输方式     | 面向报文                                   | 面向字节流                             |
| 首部开销     | 首部开销小，仅8字节                        | 首部最小20字节，最大60字节             |
| 适用场景     | 适用于实时应用（IP电话、视频会议、直播等） | 适用于要求可靠传输的应用，例如文件传输 |

1. TCP在传输数据时，如何保证数据的可靠性
   * 校验和：校验数据是否损坏
   * 序列号：用于检测丢失的分组和冗余的分组
   * 确认应答：接收方告知发送方正确接收分组以及期望的下一个分组，否定确认：接收方通知发送方未被正确接收的分组
   * 超时重传：前一个数据包超时，但能到达，重传之后会存在两个一样的数据包，因此通过编号的方式标记属于重传数据还是新数据
   * 连接管理：三次握手、四次挥手
   * 流量控制
   * 拥塞控制
   * 累积确认：多个数据包，回复一次确认。避免网络充斥大量确认回复报文
   * 选择确认SACK：选项确认字段，一个报文段（多个数据包）使用两个边界确定，选项字段有4个字节，每个边界4位，因此最多可以表示4个已接受的报文段
   * 连续ARQ（Automatic Repeat-Request，*ARQ*）：自动重传请求
2. TCP三次握手，四次挥手：为什么
3. 沾包拆包
 4. 定时器（分组丢失则重传）
 5. 窗口和流水线（用于增加信道的吞吐量）
6. 详解重传机制，超时时间怎么确定
7. TCP的滑动窗口机制
8. 局域网内两台主机，一台主机去ping另一台主机的IP，其过程
9. Android长连接的心跳机制：如何设计心跳时间，考虑哪些因素DHCP租期. NAT超时. 网络切换. 如何保证尽可能大的心跳时间 
10. UDP如何实现丢包重传策略？



https://mp.weixin.qq.com/s/G3np-WgQu3hZNICoso4X1w

https://blog.csdn.net/sinat_21112393/article/details/50810053
